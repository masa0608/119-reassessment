<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- ===================== åŸºæœ¬SEO ===================== -->
<title>æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«ï½œè¿·ã£ãŸã‚‰#7119ãƒ»æœ¬æ—¥å—è¨ºãƒ»è‡ªå·±ã‚±ã‚¢ã®ç›®å®‰</title>
<meta name="description" content="æ•‘æ€¥è»Šã‚’å‘¼ã¶ã¹ãã‹è¿·ã£ãŸã¨ãã®ãŸã‚ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«ã€‚ç ”ç©¶ãƒ»ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’å‚è€ƒã«ã€119ï¼ˆå¼·ãæ¤œè¨ï¼‰ï¼æœ¬æ—¥å—è¨ºï¼è‡ªå·±ã‚±ã‚¢ã®ç›®å®‰ã‚’æ—¥æœ¬èªã§ç°¡å˜æç¤ºã€‚#7119ã‚„å…¬çš„ã‚¬ã‚¤ãƒ‰ã¸ã®å°ç·šã¤ãã€‚">
<link rel="canonical" href="https://USERNAME.github.io/REPO/">
<meta name="robots" content="index,follow,max-image-preview:large">

<!-- ===================== OGP / Twitter ===================== -->
<meta property="og:site_name" content="æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«">
<meta property="og:title" content="æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«ï½œè¿·ã£ãŸã‚‰#7119ãƒ»æœ¬æ—¥å—è¨ºãƒ»è‡ªå·±ã‚±ã‚¢ã®ç›®å®‰">
<meta property="og:description" content="æ•‘æ€¥è»Šã‚’å‘¼ã¶ã¹ãã‹è¿·ã£ãŸã¨ãã®ãŸã‚ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«ï¼ˆä¸€èˆ¬æƒ…å ±ï¼‰ã€‚119ãƒ»å¼·ãæ¤œè¨ãƒ»æœ¬æ—¥å—è¨ºãƒ»è‡ªå·±ã‚±ã‚¢ã®ç›®å®‰ã‚’ç°¡å˜ã«åˆ¤å®šã€‚">
<meta property="og:type" content="website">
<meta property="og:url" content="https://USERNAME.github.io/REPO/">
<meta property="og:image" content="https://USERNAME.github.io/REPO/og-image.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ===================== PWAãƒ©ã‚¤ãƒˆ/å¤–è¦³ ===================== -->
<meta name="theme-color" content="#ffffff">
<link rel="icon" href="favicon.png">

<!-- ===================== æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON-LDï¼‰ ===================== -->
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"WebApplication",
  "name":"æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«",
  "url":"https://USERNAME.github.io/REPO/",
  "applicationCategory":"HealthApplication",
  "operatingSystem":"Web",
  "inLanguage":"ja",
  "description":"æ•‘æ€¥è»Šã‚’å‘¼ã¶ã¹ãã‹è¿·ã£ãŸæ™‚ã®å†åˆ¤æ–­æ”¯æ´ãƒ„ãƒ¼ãƒ«ï¼ˆä¸€èˆ¬æƒ…å ±ï¼‰ã€‚119ãƒ»å¼·ãæ¤œè¨ãƒ»æœ¬æ—¥å—è¨ºãƒ»è‡ªå·±ã‚±ã‚¢ã®ç›®å®‰ã‚’è¡¨ç¤ºã€‚",
  "provider":{
    "@type":"Organization",
    "name":"YOUR NAME / ORG",
    "url":"https://USERNAME.github.io/REPO/"
  }
}
</script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"WebSite",
  "name":"æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«",
  "url":"https://USERNAME.github.io/REPO/",
  "inLanguage":"ja",
  "potentialAction":{
    "@type":"SearchAction",
    "target":"https://USERNAME.github.io/REPO/?q={query}",
    "query-input":"required name=query"
  }
}
</script>

<style>
  :root{
    --bg1:#fff; --bg2:#f9fbff; --ink:#111; --muted:#666;
    --red:#dc2626; --orange:#f97316; --amber:#f59e0b; --green:#059669; --blue:#2563eb;
    --card:#ffffffcc; --border:#e5e7eb;
  }
  html,body{margin:0;padding:0;background:linear-gradient(135deg,#fff4f5,#f5fbff);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans JP','Hiragino Kaku Gothic ProN',Meiryo,sans-serif;}
  .container{max-width:960px;margin:0 auto;padding:16px 16px 80px;}
  h1{font-size:24px;font-weight:900;margin:8px 0 12px}
  .lead{color:#333;margin-top:4px}
  .badge{display:inline-flex;align-items:center;gap:6px;background:#000c;color:#fff;border-radius:999px;padding:6px 10px;font-size:12px}
  .card{background:var(--card);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:20px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .grow{flex:1}
  .muted{color:var(--muted);font-size:14px}
  .btn{height:46px;padding:0 18px;border-radius:12px;border:0;cursor:pointer;font-weight:800;box-shadow:0 2px 8px rgba(0,0,0,.08)}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .btn-primary{background:var(--blue);color:#fff}
  .btn-dark{background:#111827;color:#fff}
  .btn-ghost{background:#f3f4f6;color:#111827}
  .btn-danger{background:var(--red);color:#fff}
  .btn-next{width:100%}@media(min-width:768px){.btn-next{width:18rem}}
  .btn-lite{font-weight:600}
  .grid2{display:grid;grid-template-columns:1fr;gap:12px}@media(min-width:640px){.grid2{grid-template-columns:1fr 1fr}}
  .tile{height:64px;border:1px solid var(--border);border-radius:16px;background:#fafafa;display:grid;place-items:center;font-weight:700}
  .tile.active{border-color:var(--blue);background:#e8f0ff}
  .chip{padding:2px 8px;border-radius:999px;background:var(--blue);color:#fff;font-size:12px;margin-left:8px}
  .q-title{font-size:18px;font-weight:800;line-height:1.5;text-align:center}
  .subtitle-center{text-align:center;color:var(--muted)}
  .result{color:#fff;border-radius:16px;padding:12px 14px;font-weight:800}
  .bg-now{background:var(--red)} .bg-strong{background:var(--orange)}
  .bg-day{background:var(--amber)} .bg-self{background:var(--green)}
  .help{font-size:12px;color:#555;background:#fff7d6;border:1px solid #f4e6a7;border-radius:10px;padding:8px}
  footer{font-size:12px;color:#666;margin-top:14px}
  .timer{display:flex;align-items:center;gap:10px}
  .timer .circle{width:42px;height:42px;border-radius:50%;border:4px solid #e5e7eb;position:relative}
  .timer .num{position:absolute;inset:0;display:grid;place-items:center;font-weight:800}
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
  .overlay .inner{max-width:560px;width:100%;background:#fff;border-radius:18px;padding:16px;box-shadow:0 10px 32px rgba(0,0,0,.3)}
  a.link{color:#1d4ed8;text-decoration:underline}
  .hidden{display:none!important}
  .mt8{margin-top:8px}.mt12{margin-top:12px}.mt16{margin-top:16px}.mb8{margin-bottom:8px}
  .spacey>*+*{margin-top:12px}
  .yn-row{justify-content:center}
  .yn-big{height:72px;min-width:12rem;font-size:20px;border-radius:16px}
  .yn-yes-active{background:var(--red);color:#fff}
  .yn-no-active{background:#111827;color:#fff}
  .yn-inactive{background:#f3f4f6;color:#111827}
</style>
</head>
<body>
  <div class="container">
    <header class="row" style="justify-content:space-between">
      <div>
        <h1>æ•‘æ€¥è¦è«‹ã®å†åˆ¤æ–­ãƒ„ãƒ¼ãƒ«ï¼ˆè¿·ã£ãŸã‚‰#7119ã¸ï¼‰</h1>
        <p class="lead" aria-label="ã“ã®ã‚µã‚¤ãƒˆã®èª¬æ˜">
          æ•‘æ€¥è»Šã‚’å‘¼ã¶ã¹ãã‹è¿·ã£ãŸã¨ãã«ã€<strong>ä¸€èˆ¬æƒ…å ±</strong>ã¨ã—ã¦å†åˆ¤æ–­ã‚’æ”¯æ´ã—ã¾ã™ã€‚è¨ºæ–­ãƒ»æ²»ç™‚ã®æŒ‡ç¤ºã¯è¡Œã„ã¾ã›ã‚“ã€‚
        </p>
      </div>
      <span class="badge" aria-label="è¿·ã£ãŸã‚‰ã‚·ãƒ£ãƒ¼ãƒ—7119ã¸">è¿·ã£ãŸã‚‰ #7119</span>
    </header>

    <main class="card spacey" id="app">
      <!-- ã‚¿ã‚¤ãƒãƒ¼è¡Œ -->
      <section class="row" aria-label="å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒãƒ¼è¡Œ">
        <div class="row grow" style="align-items:center">
          <div class="timer" aria-live="polite">
            <div class="circle" aria-hidden="true"><div class="num" id="timerNum">0</div></div>
          </div>
          <div class="muted" id="timerText">ã€Œé€šå ±ã™ã‚‹ã‹è¿·ã£ã¦ã„ã‚‹ã€ã‚’æŠ¼ã™ã¨å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒãƒ¼ãŒé–‹å§‹ã—ã¾ã™ï¼ˆè‡ªå‹•ç™ºä¿¡ã¯ã—ã¾ã›ã‚“ï¼‰ã€‚</div>
        </div>
        <a class="btn btn-ghost" target="_blank" rel="noopener" href="https://www.fdma.go.jp/mission/enrichment/appropriate/appropriate007.html" aria-label="æ•‘æ€¥å®‰å¿ƒã‚»ãƒ³ã‚¿ãƒ¼#7119ã®æ¡ˆå†…ãƒšãƒ¼ã‚¸">#7119ï¼ˆæ¡ˆå†…ï¼‰</a>
      </section>

      <!-- HOME -->
      <section id="view-home" class="spacey" aria-label="ãƒ›ãƒ¼ãƒ ">
        <div class="grid2">
          <button class="btn btn-dark" id="btn-start" aria-label="é€šå ±ã™ã‚‹ã‹è¿·ã£ã¦ã„ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’å§‹ã‚ã‚‹">A. é€šå ±ã™ã‚‹ã‹è¿·ã£ã¦ã„ã‚‹</button>
          <button class="btn btn-danger" id="btn-panic" aria-label="æ˜ã‚‰ã‹ã«ç·Šæ€¥ã®ã¨ãã®æ¡ˆå†…ã¸é€²ã‚€">B. æ˜ã‚‰ã‹ã«ç·Šæ€¥ï¼ˆè¦è«‹ã‚’å¼·ãæ¤œè¨ï¼‰</button>
        </div>
        <div>
          <div class="muted mb8">ã‚¯ã‚¤ãƒƒã‚¯æ¤œç´¢ï¼ˆè‡ªåˆ†ã®ç—‡çŠ¶å‘ã‘ï¼‰</div>
          <div class="row">
            <button class="btn btn-ghost" data-quick="skin" aria-label="è™«ã«åˆºã•ã‚ŒãŸã§å§‹ã‚ã‚‹">è™«ã«åˆºã•ã‚ŒãŸ</button>
            <button class="btn btn-ghost" data-quick="fever" aria-label="ç™ºç†±ã§å§‹ã‚ã‚‹">ç™ºç†±</button>
            <button class="btn btn-ghost" data-quick="trauma" aria-label="å¤–å‚·ãƒ»å‡ºè¡€ã§å§‹ã‚ã‚‹">å¤–å‚·/å‡ºè¡€</button>
          </div>
        </div>
      </section>

      <!-- PICK è‡ªåˆ†/ä»–è€… -->
      <section id="view-pick" class="spacey hidden" aria-label="å¯¾è±¡ã®é¸æŠ">
        <div class="muted">å¯¾è±¡ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</div>
        <div class="grid2">
          <button class="btn btn-ghost btn-lite" id="btn-self" aria-label="è‡ªåˆ†ã®ç—‡çŠ¶ã«ã¤ã„ã¦">è‡ªåˆ†ã®ç—‡çŠ¶ã«ã¤ã„ã¦</button>
          <button class="btn btn-ghost btn-lite" id="btn-other" aria-label="ä»–è€…ã®æ§˜å­ãŒãŠã‹ã—ã„å ´åˆ">ä»–è€…ã‚’è¦‹ã¤ã‘ãŸï¼æ§˜å­ãŒãŠã‹ã—ã„äººãŒã„ã‚‹</button>
        </div>
      </section>

      <!-- ã‚«ãƒ†ã‚´ãƒªï¼ˆè‡ªåˆ†ï¼‰ -->
      <section id="view-self-cat" class="spacey hidden" aria-label="è‡ªåˆ†ã®ç—‡çŠ¶ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠ">
        <div class="muted">æœ€ã‚‚è¿‘ã„é …ç›®ã‚’é¸æŠï¼ˆè¤‡æ•°å¯ï¼‰ã€‚å„ªå…ˆåº¦ã¯è‡ªå‹•ã§æ±ºã¾ã‚Šã¾ã™ã€‚</div>
        <div id="self-tiles" class="grid2"></div>
        <div class="row" style="justify-content:flex-end">
          <button class="btn btn-ghost" id="back-self-cat">ä¸€ã¤å‰ã¸</button>
          <button class="btn btn-primary btn-next" id="next-self-cat" disabled>æ¬¡ã¸</button>
        </div>
      </section>

      <!-- è³ªå•ï¼ˆè‡ªåˆ†ï¼‰ -->
      <section id="view-self-q" class="spacey hidden" aria-label="è‡ªåˆ†ã®è³ªå•">
        <div class="row" style="align-items:center;justify-content:center;gap:8px">
          <div id="self-emoji" style="font-size:28px" aria-hidden="true">â“</div>
          <div>
            <div id="self-label" style="font-weight:800;text-align:center"></div>
            <div class="subtitle-center" id="self-subtitle"></div>
          </div>
        </div>
        <div class="spacey">
          <div class="q-title" id="self-qtext"></div>
          <div class="row yn-row" role="group" aria-label="ã¯ã„ãƒ»ã„ã„ãˆã®é¸æŠ">
            <button class="btn yn-inactive yn-big" id="self-yes" aria-label="ã¯ã„ã‚’é¸æŠ">ã¯ã„</button>
            <button class="btn yn-inactive yn-big" id="self-no" aria-label="ã„ã„ãˆã‚’é¸æŠ">ã„ã„ãˆ</button>
          </div>
          <div class="muted" style="font-size:12px;text-align:center">â€» ã€Œã¯ã„ã€ã¯ä½“èª¿ã«å•é¡ŒãŒã‚ã‚‹ï¼å¿ƒé…ãªçŠ¶æ…‹ã‚’ç¤ºã—ã¾ã™ã€‚</div>
        </div>
        <div class="row" style="justify-content:space-between">
          <button class="btn btn-ghost" id="self-back">ä¸€ã¤å‰ã¸</button>
          <button class="btn btn-primary btn-next" id="self-next">æ¬¡ã¸</button>
        </div>
      </section>

      <!-- ã‚«ãƒ†ã‚´ãƒªï¼ˆä»–è€…ï¼‰ -->
      <section id="view-other-cat" class="spacey hidden" aria-label="ä»–è€…ã®çŠ¶æ…‹ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠ">
        <div class="muted">è¦‹ã¦ã‚ã‹ã‚‹çŠ¶æ…‹ã‚’é¸æŠï¼ˆè¤‡æ•°å¯ï¼‰ã€‚å„ªå…ˆåº¦ã¯è‡ªå‹•ã§æ±ºã¾ã‚Šã¾ã™ã€‚</div>
        <div id="other-tiles" class="grid2"></div>
        <div class="row" style="justify-content:flex-end">
          <button class="btn btn-ghost" id="back-other-cat">ä¸€ã¤å‰ã¸</button>
          <button class="btn btn-primary btn-next" id="next-other-cat" disabled>æ¬¡ã¸</button>
        </div>
      </section>

      <!-- è³ªå•ï¼ˆä»–è€…ï¼‰ -->
      <section id="view-other-q" class="spacey hidden" aria-label="ä»–è€…ã®è³ªå•">
        <div class="row" style="align-items:center;justify-content:center;gap:8px">
          <div id="other-emoji" style="font-size:28px" aria-hidden="true">â“</div>
          <div>
            <div id="other-label" style="font-weight:800;text-align:center"></div>
            <div class="subtitle-center" id="other-subtitle"></div>
          </div>
        </div>
        <div class="spacey">
          <div class="q-title" id="other-qtext"></div>
          <div class="row yn-row" role="group" aria-label="ã¯ã„ãƒ»ã„ã„ãˆã®é¸æŠ">
            <button class="btn yn-inactive yn-big" id="other-yes" aria-label="ã¯ã„ã‚’é¸æŠ">ã¯ã„</button>
            <button class="btn yn-inactive yn-big" id="other-no" aria-label="ã„ã„ãˆã‚’é¸æŠ">ã„ã„ãˆ</button>
          </div>
          <div class="muted" style="font-size:12px;text-align:center">â€» ã€Œã¯ã„ã€ã¯ä½“èª¿ã«å•é¡ŒãŒã‚ã‚‹ï¼å¿ƒé…ãªçŠ¶æ…‹ã‚’ç¤ºã—ã¾ã™ã€‚</div>
        </div>
        <div class="row" style="justify-content:space-between">
          <button class="btn btn-ghost" id="other-back">ä¸€ã¤å‰ã¸</button>
          <button class="btn btn-primary btn-next" id="other-next">æ¬¡ã¸</button>
        </div>
      </section>

      <!-- çµæœ -->
      <section id="view-result" class="spacey hidden" aria-label="åˆ¤å®šçµæœ">
        <div id="result-box" class="result">åˆ¤å®š</div>
        <div class="help" aria-label="å…è²¬ã®èª¬æ˜">
          <b>å…è²¬ï¼š</b>æœ¬ã‚µã‚¤ãƒˆã¯æ•‘æ€¥è¦è«‹ã®ã€Œå†åˆ¤æ–­ã€ã‚’æ”¯æ´ã™ã‚‹ä¸€èˆ¬æƒ…å ±ã§ã™ã€‚è¨ºæ–­ãƒ»æ²»ç™‚ã®æŒ‡ç¤ºã¯è¡Œã„ã¾ã›ã‚“ã€‚è¿·ã£ãŸã‚‰ #7119 ç­‰ã®å…¬çš„çª“å£ã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚
        </div>
        <div id="consult" class="spacey" aria-label="å…¬çš„æ¡ˆå†…ã¸ã®ãƒªãƒ³ã‚¯">
          <div class="muted">è‡ªåŠ›å—è¨ºãƒ»ç›¸è«‡ã®å…¬çš„å°ç·š</div>
          <div class="row">
            <a class="btn btn-ghost" target="_blank" rel="noopener" href="https://www.tfd.metro.tokyo.lg.jp/hp-kyuuimuka/guide/main/index.html">æ±äº¬ç‰ˆ æ•‘æ€¥å—è¨ºã‚¬ã‚¤ãƒ‰</a>
            <a class="btn btn-ghost" target="_blank" rel="noopener" href="https://www.fdma.go.jp/mission/enrichment/appropriate/appropriate007.html">#7119ï¼ˆåˆ¶åº¦è§£èª¬ï¼‰</a>
            <a class="btn btn-ghost" target="_blank" rel="noopener" href="https://www.tfd.metro.tokyo.lg.jp/lfe/kyuu_adv/soudan-center.html">æ±äº¬æ¶ˆé˜²åº #7119</a>
          </div>
        </div>
        <div class="row" style="justify-content:flex-end">
          <button class="btn btn-ghost" id="to-top">ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</button>
        </div>
      </section>
    </main>

    <footer aria-label="ãƒ•ãƒƒã‚¿ãƒ¼">
      <p>
        æœ¬ã‚µã‚¤ãƒˆã¯æ•‘æ€¥è¦è«‹ã®ã€Œå†åˆ¤æ–­ã€ã‚’æ”¯æ´ã™ã‚‹ä¸€èˆ¬æƒ…å ±ã§ã™ã€‚è¨ºæ–­ãƒ»æ²»ç™‚ã®æŒ‡ç¤ºã¯è¡Œã„ã¾ã›ã‚“ã€‚è¿·ã£ãŸã‚‰ #7119 ç­‰ã®å…¬çš„çª“å£ã‚’åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚<br>
        é‹å–¶ï¼šYOUR NAME / ORG ï½œ é€£çµ¡å…ˆï¼šcontact@example.com ï½œ æœ€çµ‚æ›´æ–°ï¼š2025-10-09
      </p>
      <div class="row mt8">
        <a class="link" href="#terms" id="link-terms">åˆ©ç”¨è¦ç´„</a>
        <a class="link" href="#privacy" id="link-privacy">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      </div>
    </footer>
  </div>

  <!-- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ">
    <div class="inner spacey">
      <div class="result bg-now">å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒãƒ¼ãŒ0ç§’ã«ãªã‚Šã¾ã—ãŸ</div>
      <div>è¿·ã†å ´åˆã¯<strong>å®‰å…¨å´</strong>ã«å€’ã—ã¦ãã ã•ã„ã€‚<br>ç—‡çŠ¶ãŒç¶šã/æ‚ªåŒ–ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<strong>ç·Šæ€¥ã«è¦è«‹ã‚’å¼·ãæ¤œè¨ã—ã¦ãã ã•ã„ã€‚</strong></div>
      <div class="row">
        <button class="btn btn-primary btn-next" id="ov-call">ç·Šæ€¥ã«è¦è«‹ã‚’å¼·ãæ¤œè¨ã™ã‚‹</button>
        <button class="btn btn-dark btn-next" id="ov-back">çŠ¶æ…‹è¨˜å…¥ã®è³ªå•ã«æˆ»ã‚‹</button>
      </div>
      <div class="muted">â€» åˆ¤æ–­ã«è¿·ã†å ´åˆã¯ <a class="link" target="_blank" rel="noopener" href="https://www.fdma.go.jp/mission/enrichment/appropriate/appropriate007.html">#7119ï¼ˆæ•‘æ€¥å®‰å¿ƒã‚»ãƒ³ã‚¿ãƒ¼ï¼‰</a> ã¸ã€‚</div>
    </div>
  </div>

<script>
/* ========= ãƒ‡ãƒ¼ã‚¿å®šç¾© ========= */
const PRIORITY_SELF = ["conscious","stroke","cardioresp","trauma","fever","skin"];
const SELF = [
  {key:"conscious", label:"æ„è­˜ãŒãŠã‹ã—ã„/ã‘ã„ã‚Œã‚“", emoji:"ğŸ§ ",
    red:{id:"co_rf", text:"å‘¼ã³ã‹ã‘ã«åå¿œãŒãªã„ã€ã¾ãŸã¯ ã‘ã„ã‚Œã‚“ãŒç¶šã/5åˆ†ä»¥ä¸Š/ä½•åº¦ã‚‚èµ·ãã¦ã„ã¾ã™ã‹ï¼Ÿ"},
    border:[{id:"co_head", text:"é ­ã‚’ã¶ã¤ã‘ãŸå¾Œã€åã/ã¼ã‚“ã‚„ã‚Šã™ã‚‹/æ§˜å­ãŒãŠã‹ã—ã„ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"co_blood", text:"è¡€ã‚’ã•ã‚‰ã•ã‚‰ã«ã™ã‚‹è–¬ï¼ˆæŠ—å‡å›ºãƒ»æŠ—è¡€å°æ¿ï¼‰ã‚’é£²ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.co_rf ? "CALL_NOW" : (a.co_head||r>0) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"stroke", label:"ç‰‡å´ã®æ‰‹è¶³ãŒå‹•ã‹ã—ã«ãã„/ã‚ã‚Œã¤ãŒå›ã‚‰ãªã„", emoji:"ğŸ«¥",
    red:{id:"s_rf", text:"é¡”ã®ã‚†ãŒã¿/ç‰‡è…•ãŒä¸ŠãŒã‚‰ãªã„/ã†ã¾ãè©±ã›ãªã„ï¼ˆã„ãšã‚Œã‹ï¼‰ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"s_bal", text:"ãµã‚‰ã¤ã„ã¦æ­©ã‘ãªã„/ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œãªã„ã§ã™ã‹ï¼Ÿ"},{id:"s_vis", text:"ç‰‡ç›®ãŒè¦‹ãˆã«ãã„/äºŒé‡ã«è¦‹ãˆã‚‹ãªã©è¦‹ãˆæ–¹ã®å¤‰åŒ–ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"}],
    risk:[{id:"s_time", text:"ç™ºç—‡ãŒ4.5æ™‚é–“ä»¥å†…ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿï¼ˆã¯ã£ãã‚Šã—ãªã„å ´åˆã‚‚ã€Œã¯ã„ã€ï¼‰"}],
    decide:(a,r)=> a.s_rf ? "CALL_NOW" : (a.s_bal||a.s_vis) ? (r>0?"CALL_STRONGLY":"SAME_DAY") : "SAME_DAY"
  },
  {key:"cardioresp", label:"èƒ¸ã®ç—›ã¿/æ¯è‹¦ã—ã•", emoji:"â¤ï¸â€ğŸ”¥",
    red:{id:"cr_rf", text:"åœ§è¿«/ç· ã‚ä»˜ã‘èƒ¸ç—›ãŒ10åˆ†ä»¥ä¸Šç¶šãã€ã¾ãŸã¯ ä¸€æ¯ã§è©±ã›ãªã„/ãã¡ã³ã‚‹ãŒé’ã„ ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"cr_rad", text:"ç—›ã¿ãŒ ã‚ã”/è‚©/èƒŒä¸­/è…• ã«åºƒãŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"},{id:"cr_aut", text:"å†·ã‚„æ±—/åãæ°—ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"},{id:"cr_wheeze", text:"ãœã„ãœã„ãŒå¼·ãã€ä¼‘ã‚“ã§ã‚‚è‰¯ããªã‚Šã«ãã„ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"cr_risk", text:"å¿ƒè‡“ãƒ»è‚ºã®ç—…æ°—ã®é€šé™¢ä¸­/ç³–å°¿ç—…/é«˜é½¢ãªã©ã€å¿ƒé…ãªæ¡ä»¶ãŒè¤‡æ•°ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r,mins)=> a.cr_rf ? "CALL_NOW" : (a.cr_rad||a.cr_aut||a.cr_wheeze||r>0) ? "CALL_STRONGLY" : (mins>=20?"CALL_STRONGLY":"SAME_DAY")
  },
  {key:"trauma", label:"å¤–å‚·/å‡ºè¡€", emoji:"ğŸ©¸",
    red:{id:"t_rf", text:"å¼·ãæŠ¼ã•ãˆã¦ã‚‚è¡€ãŒæ­¢ã¾ã‚‰ãªã„ã€ã¾ãŸã¯ é«˜ã„æ‰€ã‹ã‚‰ã®è»¢è½/äº¤é€šäº‹æ•…ãªã©ãŒã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ"},
    border:[{id:"t_headhit", text:"é ­ã‚’ã¶ã¤ã‘ã¾ã—ãŸã‹ï¼Ÿ"},{id:"t_symp", text:"ãã®å¾Œã€åã/é ­ç—›ãŒæ‚ªåŒ–/ã¼ã‚“ã‚„ã‚Š/æ§˜å­ã®å¤‰åŒ–ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"}],
    risk:[{id:"t_blood", text:"è¡€ã‚’ã•ã‚‰ã•ã‚‰ã«ã™ã‚‹è–¬ã‚’é£²ã‚“ã§ã„ã‚‹/65æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.t_rf ? "CALL_NOW" : (a.t_headhit && (a.t_symp||r>0)) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"fever", label:"ç™ºç†±ï¼‹ãã£ãŸã‚Š/æ°´åˆ†ãŒã¨ã‚Œãªã„", emoji:"ğŸŒ¡ï¸",
    red:{id:"f_rf", text:"å¼·ã„çœ æ°—/æ··ä¹±ã€ã¾ãŸã¯ å‘¼å¸ãŒé€Ÿã„/æ¯è‹¦ã—ã„ ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"f_poor", text:"ã»ã¨ã‚“ã©æ°´åˆ†ãŒã¨ã‚Œãªã„/ãŠã—ã£ã“ãŒæ¥µç«¯ã«å°‘ãªã„ã§ã™ã‹ï¼Ÿ"},{id:"f_persist", text:"é«˜ã„ç†±ãŒç¶šã/æ‚ªããªã£ã¦ãã¦ã„ã¾ã™ã‹ï¼Ÿ"}],
    risk:[{id:"f_worry", text:"é«˜é½¢/å¦Šå¨ ä¸­/å…ç–«ãŒå¼±ã„/é€æãªã©ã€å¿ƒé…ãªæ¡ä»¶ã«å½“ã¦ã¯ã¾ã‚Šã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> (a.f_rf||r>0) ? "CALL_STRONGLY" : (a.f_poor||a.f_persist) ? "SAME_DAY" : "SELF_CARE"
  },
  {key:"skin", label:"çš®ãµã®ã¯ã‚Œãƒ»è™«ã•ã•ã‚Œãƒ»å…¨èº«ã®å¼·ã„åå¿œ", emoji:"ğŸ¦Ÿ",
    red:{id:"sk_rf", text:"æ¯è‹¦ã—ã•/å£°ãŒã‚Œ/ã®ã©ã®ã¯ã‚Œï¼‹é¡”ã®ã¯ã‚Œ/ã˜ã‚“ã¾ã—ã‚“ ãªã©å…¨èº«ã«å‡ºã¦ã„ã¾ã™ã‹ï¼Ÿ"},
    border:[{id:"sk_spread", text:"ã•ã•ã‚Œ/æ¥è§¦å¾Œã€ã¯ã‚ŒãŒ ã™ãåºƒãŒã£ã¦ã„ã¾ã™ã‹ï¼Ÿ"},{id:"sk_sizepain", text:"ã¯ã‚ŒãŒå¤§ãã„ï¼ˆ3cmä»¥ä¸Šç›®å®‰ï¼‰ã¾ãŸã¯å¼·ã„ç—›ã¿ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"},{id:"sk_tick", text:"ãƒãƒ€ãƒ‹ãŒé£Ÿã„è¾¼ã‚“ã§å–ã‚Œã¾ã›ã‚“ã‹ï¼Ÿï¼ˆè‡ªåˆ†ã§æŠœã‹ãªã„ï¼‰"}],
    risk:[{id:"sk_worry", text:"å°å…/é«˜é½¢/å¦Šå¨ ä¸­/å‘¼å¸ã®ç—…æ°—/å¼·ã„ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã®çµŒé¨“ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"},{id:"sk_remote", text:"ç—…é™¢ã¾ã§1æ™‚é–“ä»¥ä¸Šã‹ã‹ã‚‹å ´æ‰€ã§ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.sk_rf ? "CALL_NOW" : (a.sk_spread||a.sk_sizepain||(r>0&&(a.sk_spread||a.sk_sizepain))) ? "CALL_STRONGLY" : a.sk_tick ? "SAME_DAY" : (!a.sk_spread&&!a.sk_sizepain&&!a.sk_tick) ? "SELF_CARE" : "SAME_DAY"
  }
];

const PRIORITY_OTHER = ["other_conscious","other_stroke","other_cardioresp","other_trauma","other_allergy","other_fever"];
const OTHER = [
  {key:"other_conscious", label:"åå¿œãŒãªã„/ã‘ã„ã‚Œã‚“ï¼ˆè¦³å¯Ÿï¼‰", emoji:"ğŸ§ ",
    red:{id:"o_co_rf", text:"å‘¼ã³ã‹ã‘ã«åå¿œãŒãªã„ã€ã¾ãŸã¯ ã‘ã„ã‚Œã‚“ãŒç¶šã/5åˆ†ä»¥ä¸Š/ä½•åº¦ã‚‚èµ·ãã¦ã„ã¾ã™ã‹ï¼Ÿ"},
    border:[{id:"o_co_head", text:"é ­ã‚’ã¶ã¤ã‘ãŸå¾Œã€åã/ã¼ã‚“ã‚„ã‚Š/æ§˜å­ãŒãŠã‹ã—ã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_co_worry", text:"é«˜é½¢/å°å…/å¦Šå¨ ä¸­/è¡€ã‚’ã•ã‚‰ã•ã‚‰ã«ã™ã‚‹è–¬/æŒç—…ã‚ã‚Šã«è¦‹ãˆã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.o_co_rf ? "CALL_NOW" : (a.o_co_head||r>0) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"other_stroke", label:"ç‰‡å´ãŒå‹•ã‹ã—ã«ãã„/ã‚ã‚Œã¤ä¸æ˜ç­ï¼ˆè¦³å¯Ÿï¼‰", emoji:"ğŸ«¥",
    red:{id:"o_s_rf", text:"é¡”ã®ã‚†ãŒã¿/ç‰‡è…•ãŒä¸ŠãŒã‚‰ãªã„/è©±ã—æ–¹ãŒãŠã‹ã—ã„ï¼ˆã„ãšã‚Œã‹ï¼‰ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"o_s_bal", text:"ãµã‚‰ã¤ã„ã¦æ­©ã‘ãªã„/ãƒãƒ©ãƒ³ã‚¹ãŒæ‚ªã„æ§˜å­ã§ã™ã‹ï¼Ÿ"},{id:"o_s_vis", text:"ç‰‡ç›®ãŒè¦‹ãˆã«ãã„/äºŒé‡ã«è¦‹ãˆã‚‹æ§˜å­ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_s_time", text:"èµ·ããŸã®ãŒ4.5æ™‚é–“ä»¥å†…ã‚‰ã—ã„/ãã®å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.o_s_rf ? "CALL_NOW" : (a.o_s_bal||a.o_s_vis) ? (r>0?"CALL_STRONGLY":"SAME_DAY") : "SAME_DAY"
  },
  {key:"other_cardioresp", label:"æ¯è‹¦ã—ã•/èƒ¸ã‚’æŠ¼ã•ãˆã‚‹ï¼ˆè¦³å¯Ÿï¼‰", emoji:"â¤ï¸â€ğŸ”¥",
    red:{id:"o_cr_rf", text:"ä¸€æ¯ã§è©±ã›ãªã„ã»ã©æ¯è‹¦ã—ã„/ãã¡ã³ã‚‹ãŒé’ã„æ§˜å­ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"o_cr_pain", text:"èƒ¸ã‚’æŠ¼ã•ãˆã‚‹/è‹¦ã—ãã†/å†·ã‚„æ±—ãƒ»åãæ°—ã®æ§˜å­ã§ã™ã‹ï¼Ÿ"},{id:"o_cr_wheeze", text:"ãœã„ãœã„ãŒå¼·ãã€ä¼‘ã¾ã›ã¦ã‚‚æ¥½ã«ãªã‚‰ãªã„æ§˜å­ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_cr_worry", text:"é«˜é½¢/æŒç—…ã‚ã‚Šã«è¦‹ãˆã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> a.o_cr_rf ? "CALL_NOW" : (a.o_cr_pain||a.o_cr_wheeze||r>0) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"other_trauma", label:"å¤§ããªå‡ºè¡€/å¼·ã„ã‘ãŒï¼ˆè¦³å¯Ÿï¼‰", emoji:"ğŸ©¸",
    red:{id:"o_t_rf", text:"å¼·ãæŠ¼ã•ãˆã¦ã‚‚å‡ºè¡€ãŒæ­¢ã¾ã‚‰ãªã„ã€ã¾ãŸã¯ é«˜ã„æ‰€ã‹ã‚‰è½ã¡ãŸ/äº¤é€šäº‹æ•…ãªã©ãŒã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ"},
    border:[{id:"o_t_head", text:"é ­ã‚’ã¶ã¤ã‘ãŸã‚ˆã†ã«è¦‹ãˆã¾ã™ã‹ï¼Ÿ"},{id:"o_t_post", text:"ãã®å¾Œã€åã/é ­ç—›ãŒæ‚ªåŒ–/ã¼ã‚“ã‚„ã‚Š/æ§˜å­ãŒå¤‰ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_t_worry", text:"é«˜é½¢/è¡€ã‚’ã•ã‚‰ã•ã‚‰ã«ã™ã‚‹è–¬ã‚’é£²ã‚“ã§ã„ãã†ã§ã™ã‹ï¼Ÿï¼ˆã‚ã‹ã‚‹ç¯„å›²ã§ï¼‰"}],
    decide:(a,r)=> a.o_t_rf ? "CALL_NOW" : (a.o_t_head&&(a.o_t_post||r>0)) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"other_allergy", label:"é¡”ã®ã¯ã‚Œ/ã˜ã‚“ã¾ã—ã‚“ï¼‹æ¯è‹¦ã—ã•ï¼ˆè¦³å¯Ÿï¼‰", emoji:"ğŸ¦Ÿ",
    red:{id:"o_a_rf", text:"æ¯è‹¦ã—ã•/å£°ãŒã‚Œ/ã®ã©ã®ã¯ã‚Œï¼‹é¡”ã®ã¯ã‚Œ/ã˜ã‚“ã¾ã—ã‚“ ãªã©å…¨èº«ã«å‡ºã¦ã„ã¾ã™ã‹ï¼Ÿ"},
    border:[{id:"o_a_spread", text:"ã•ã•ã‚Œ/æ¥è§¦å¾Œã€ã¯ã‚ŒãŒã™ãåºƒãŒã£ã¦ã„ã‚‹æ§˜å­ã§ã™ã‹ï¼Ÿ"},{id:"o_a_sizepain", text:"ã¯ã‚ŒãŒå¤§ãã„ï¼ˆ3cmä»¥ä¸Šç›®å®‰ï¼‰ã¾ãŸã¯å¼·ã„ç—›ã¿ãŒã‚ã‚Šãã†ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_a_history", text:"ä»¥å‰ã«å¼·ã„ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼åå¿œã‚’èµ·ã“ã—ãŸã“ã¨ãŒã‚ã‚‹ã¨èãã¾ã—ãŸã‹ï¼Ÿ"}],
    decide:(a,r)=> a.o_a_rf ? "CALL_NOW" : (a.o_a_spread||a.o_a_sizepain||r>0) ? "CALL_STRONGLY" : "SAME_DAY"
  },
  {key:"other_fever", label:"ãã£ãŸã‚Š/ç™ºç†±ï¼ˆè¦³å¯Ÿï¼‰", emoji:"ğŸŒ¡ï¸",
    red:{id:"o_f_rf", text:"å¼·ã„æ··ä¹±/ã­ã‚€ã‘ã€ã¾ãŸã¯ å‘¼å¸ãŒé€Ÿã„/æ¯è‹¦ã—ãã† ã§ã™ã‹ï¼Ÿ"},
    border:[{id:"o_f_leth", text:"ãã£ãŸã‚Šã—ã¦ã€æ°´åˆ†ãŒã¨ã‚Œã¦ã„ãªã„æ§˜å­ã§ã™ã‹ï¼Ÿ"},{id:"o_f_persist", text:"é«˜ã„ç†±ãŒç¶šãã€æ‚ªåŒ–ã—ã¦ã„ã‚‹æ§˜å­ã§ã™ã‹ï¼Ÿ"}],
    risk:[{id:"o_f_worry", text:"é«˜é½¢/å°å…/å¦Šå¨ ä¸­/å…ç–«ãŒå¼±ã„ ãªã©ã«è¦‹ãˆã¾ã™ã‹ï¼Ÿ"}],
    decide:(a,r)=> (a.o_f_rf||r>0) ? "CALL_STRONGLY" : (a.o_f_leth||a.o_f_persist) ? "SAME_DAY" : "SELF_CARE"
  }
];

const CAT_LABEL = {
  CALL_NOW:{title:"â‘  ã„ã¾æ•‘æ€¥è¦è«‹ãŒå¿…è¦ãªå¯èƒ½æ€§ãŒé«˜ã„", color:"bg-now", reason:"é‡å¤§ãªå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚è‡³æ€¥ã€æ•‘æ€¥è¦è«‹ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚"},
  CALL_STRONGLY:{title:"â‘¡ æ•‘æ€¥è¦è«‹ã‚’å¼·ãæ¤œè¨", color:"bg-strong", reason:"é‡ã„ç—…æ°—ã‚„æ‚ªåŒ–ã®å…†å€™ãŒè¤‡æ•°ã‚ã‚Šã¾ã™ã€‚æ•‘æ€¥è¦è«‹ã®æ¤œè¨ã‚’å¼·ããŠã™ã™ã‚ã—ã¾ã™ã€‚"},
  SAME_DAY:{title:"â‘¢ æœ¬æ—¥ä¸­ã«å—è¨º", color:"bg-day", reason:"ç·Šæ€¥æ€§ã¯é«˜ããªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚æœ¬æ—¥ä¸­ã®å—è¨ºã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚"},
  SELF_CARE:{title:"â‘£ è‡ªå·±ã‚±ã‚¢ï¼‹å†è©•ä¾¡", color:"bg-self", reason:"è‡ªå·±ã‚±ã‚¢ã§çµŒéè¦³å¯Ÿå¯èƒ½ãªè¦‹è¾¼ã¿ã§ã™ã€‚"}
};

/* ========= çŠ¶æ…‹ã¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========= */
let route="HOME", who="SELF";
let timerActive=false, timerMax=30, timerCount=0, timerId=null;
let startAt=null;
let selections=new Set(); let focusKey=null;
let step="RED"; let idx=0; let answers={}; let resultCat="CALL_NOW";

const $=sel=>document.querySelector(sel);
const show=(id,flag)=>{ const el=$(id); if(!el)return; el.classList.toggle('hidden', !flag); };
function setTimer(active,max){
  clearInterval(timerId); timerActive=active; timerMax=max; timerCount=max;
  $('#timerNum').textContent=active?timerCount:0;
  $('#timerText').textContent=active? 'å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒãƒ¼ä½œå‹•ä¸­ã€‚0ã§ç·Šæ€¥æ¡ˆå†…ãŒå‡ºã¾ã™ã€‚' :
    'ã€Œé€šå ±ã™ã‚‹ã‹è¿·ã£ã¦ã„ã‚‹ã€ã‚’æŠ¼ã™ã¨å®‰å…¨ç¢ºèªã‚¿ã‚¤ãƒãƒ¼ãŒé–‹å§‹ã—ã¾ã™ï¼ˆè‡ªå‹•ç™ºä¿¡ã¯ã—ã¾ã›ã‚“ï¼‰ã€‚';
  if(!active) return;
  timerId=setInterval(()=>{
    timerCount--; $('#timerNum').textContent=timerCount;
    if(timerCount<=0){ clearInterval(timerId); timerActive=false; $('#overlay').style.display='flex'; }
  },1000);
}
function resetFlow(){ selections.clear(); focusKey=null; step="RED"; idx=0; answers={}; }
function getList(){ return who==="SELF"?SELF:OTHER; }
function getPriority(){ return who==="SELF"?PRIORITY_SELF:PRIORITY_OTHER; }
function pickFocus(){ for(const k of getPriority()){ if(selections.has(k)){ focusKey=k; return; } } focusKey=[...selections][0]||null; }
function minutesPersisted(){ if(!startAt) return 0; return Math.max(0, Math.round((Date.now()-startAt)/60000)); }

/* ========= ç”»é¢æç”» ========= */
function render(){
  ['#view-home','#view-pick','#view-self-cat','#view-self-q','#view-other-cat','#view-other-q','#view-result']
    .forEach(id=>show(id,false));
  if(route==='HOME'){ show('#view-home',true); return; }
  if(route==='PICK'){ show('#view-pick',true); return; }
  if(route==='SELF_CAT'){ buildTiles('#self-tiles', SELF); $('#next-self-cat').disabled=!focusKey; show('#view-self-cat',true); return; }
  if(route==='SELF_Q'){ buildQuestion('SELF'); show('#view-self-q',true); return; }
  if(route==='OTHER_CAT'){ buildTiles('#other-tiles', OTHER); $('#next-other-cat').disabled=!focusKey; show('#view-other-cat',true); return; }
  if(route==='OTHER_Q'){ buildQuestion('OTHER'); show('#view-other-q',true); return; }
  if(route==='RESULT'){ buildResult(); show('#view-result',true); return; }
}
function buildTiles(containerSel, data){
  const el=$(containerSel); el.innerHTML='';
  for(const s of data){
    const btn=document.createElement('button');
    btn.className='tile'+(selections.has(s.key)?' active':'');
    btn.setAttribute('aria-pressed', selections.has(s.key)?'true':'false');
    btn.innerHTML=`<span style="font-size:20px;margin-right:8px">${s.emoji}</span>${s.label}`+(focusKey===s.key?`<span class="chip">å„ªå…ˆ</span>`:'');
    btn.onclick=()=>{ if(selections.has(s.key)) selections.delete(s.key); else selections.add(s.key); pickFocus(); render(); };
    el.appendChild(btn);
  }
}
function currentSymptom(){ return getList().find(s=>s.key===focusKey); }
function updateYNStyles(side){
  const cfg=currentSymptom(); if(!cfg) return;
  const prefix = (side==='SELF'?'self':'other');
  let v;
  if(step==='RED'){ v = answers[cfg.red.id]; }
  else{
    const qset = step==='BORDER' ? cfg.border : cfg.risk;
    v = answers[qset[idx]?.id];
  }
  const yesBtn = $('#'+prefix+'-yes');
  const noBtn  = $('#'+prefix+'-no');
  yesBtn.className = 'btn yn-big ' + (v===true  ? 'yn-yes-active' : 'yn-inactive');
  noBtn.className  = 'btn yn-big ' + (v===false ? 'yn-no-active'  : 'yn-inactive');
}
function buildQuestion(side){
  const cfg=currentSymptom();
  $('#'+(side==='SELF'?'self':'other')+'-emoji').textContent=cfg.emoji;
  $('#'+(side==='SELF'?'self':'other')+'-label').textContent=cfg.label;
  const qset = step==='RED' ? [cfg.red] : step==='BORDER' ? cfg.border : cfg.risk;
  const subtitle = step==='RED' ? 'ã¾ãšæœ€åˆã«ç¢ºèªï¼ˆã€Œã¯ã„ã€ã¯å•é¡Œã‚ã‚Šï¼‰'
                  : step==='BORDER' ? `ã‚‚ã†å°‘ã—ç¢ºèªï¼ˆ${idx+1}/${qset.length}ï¼‰`
                  : `æ°—ã‚’ã¤ã‘ã‚‹æ¡ä»¶ã®ç¢ºèªï¼ˆ${idx+1}/${qset.length}ï¼‰`;
  $('#'+(side==='SELF'?'self':'other')+'-subtitle').textContent=subtitle;
  const q = (step==='RED') ? cfg.red : qset[idx];
  $('#'+(side==='SELF'?'self':'other')+'-qtext').textContent=q.text;
  updateYNStyles(side);
}
function buildResult(){
  const meta=CAT_LABEL[resultCat];
  const box=$('#result-box');
  box.className='result '+meta.color;
  box.textContent=meta.title+' â€” '+meta.reason;
  $('#consult').style.display = (resultCat==='SAME_DAY' || resultCat==='SELF_CARE') ? 'block':'none';
}

/* ========= ã‚¤ãƒ™ãƒ³ãƒˆ ========= */
document.getElementById('btn-start').onclick=()=>{ route='PICK'; setTimer(true,30); startAt=Date.now(); render(); };
document.getElementById('btn-panic').onclick=()=>{ route='RESULT'; resultCat='CALL_NOW'; setTimer(false,0); render(); };
document.querySelectorAll('[data-quick]').forEach(b=>{
  b.onclick=()=>{ who='SELF'; resetFlow(); selections.add(b.dataset.quick); pickFocus(); route='SELF_CAT'; setTimer(true,30); startAt=Date.now(); render(); };
});
document.getElementById('btn-self').onclick=()=>{ who='SELF'; resetFlow(); route='SELF_CAT'; setTimer(true,30); render(); };
document.getElementById('btn-other').onclick=()=>{ who='OTHER'; resetFlow(); route='OTHER_CAT'; setTimer(true,30); render(); };

/* è‡ªåˆ†ã‚«ãƒ†ã‚´ãƒª */
document.getElementById('back-self-cat').onclick=()=>{ route='PICK'; setTimer(true,30); render(); };
document.getElementById('next-self-cat').onclick=()=>{ if(!focusKey)return; route='SELF_Q'; step='RED'; idx=0; setTimer(true,10); render(); };

/* ä»–è€…ã‚«ãƒ†ã‚´ãƒª */
document.getElementById('back-other-cat').onclick=()=>{ route='PICK'; setTimer(true,30); render(); };
document.getElementById('next-other-cat').onclick=()=>{ if(!focusKey)return; route='OTHER_Q'; step='RED'; idx=0; setTimer(true,10); render(); };

/* è‡ªåˆ†ï¼šè³ªå• */
document.getElementById('self-yes').onclick=()=>{ handleAnswer(true,'SELF'); };
document.getElementById('self-no').onclick=()=>{ handleAnswer(false,'SELF'); };
document.getElementById('self-back').onclick=()=>{ goBack('SELF'); };
document.getElementById('self-next').onclick=()=>{ goNext('SELF'); };

/* ä»–è€…ï¼šè³ªå• */
document.getElementById('other-yes').onclick=()=>{ handleAnswer(true,'OTHER'); };
document.getElementById('other-no').onclick=()=>{ handleAnswer(false,'OTHER'); };
document.getElementById('other-back').onclick=()=>{ goBack('OTHER'); };
document.getElementById('other-next').onclick=()=>{ goNext('OTHER'); };

/* çµæœ */
document.getElementById('to-top').onclick=()=>{ route='HOME'; setTimer(false,0); render(); };

/* ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
document.getElementById('ov-call').onclick=()=>{ document.getElementById('overlay').style.display='none'; route='RESULT'; resultCat='CALL_NOW'; render(); };
document.getElementById('ov-back').onclick=()=>{ document.getElementById('overlay').style.display='none'; setTimer(true,10); render(); };

/* å›ç­”å‡¦ç† */
function handleAnswer(val, side){
  const cfg=currentSymptom();
  if(step==='RED'){ answers[cfg.red.id]=val; }
  else{
    const qset = step==='BORDER' ? cfg.border : cfg.risk;
    answers[qset[idx].id]=val;
  }
  updateYNStyles(side);
}
function goNext(side){
  const cfg=currentSymptom();
  const mins = minutesPersisted();
  if(step==='RED'){
    if(answers[cfg.red.id]===true){ resultCat='CALL_NOW'; route='RESULT'; setTimer(false,0); render(); return; }
    if(cfg.border.length){ step='BORDER'; idx=0; setTimer(true,10); render(); return; }
    if(cfg.risk.length){ step='RISK'; idx=0; setTimer(true,10); render(); return; }
    const rYes = cfg.risk.reduce((n,q)=> n + (answers[q.id]?1:0), 0);
    resultCat = cfg.decide(answers, rYes, mins);
    route='RESULT'; setTimer(false,0); render(); return;
  }
  if(step==='BORDER'){
    if(idx < cfg.border.length-1){ idx++; setTimer(true,10); render(); return; }
    if(cfg.risk.length){ step='RISK'; idx=0; setTimer(true,10); render(); return; }
    const rYes = 0;
    resultCat = cfg.decide(answers, rYes, mins);
    route='RESULT'; setTimer(false,0); render(); return;
  }
  if(step==='RISK'){
    if(idx < cfg.risk.length-1){ idx++; setTimer(true,10); render(); return; }
    const rYes = cfg.risk.reduce((n,q)=> n + (answers[q.id]?1:0), 0);
    resultCat = cfg.decide(answers, rYes, mins);
    route='RESULT'; setTimer(false,0); render(); return;
  }
}
function goBack(side){
  if(step==='RED'){ route = (side==='SELF'?'SELF_CAT':'OTHER_CAT'); setTimer(true,30); render(); return; }
  if(step==='BORDER'){
    if(idx>0){ idx--; setTimer(true,10); render(); return; }
    step='RED'; setTimer(true,10); render(); return;
  }
  if(step==='RISK'){
    if(idx>0){ idx--; setTimer(true,10); render(); return; }
    step='BORDER'; setTimer(true,10); render(); return;
  }
}

/* è¦ç´„/ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ï¼šåŒä¸€ãƒšãƒ¼ã‚¸ã®ç°¡æ˜“è¡¨ç¤ºï¼ˆæœ¬ç•ªã¯åˆ¥ãƒšãƒ¼ã‚¸ã§ã‚‚OKï¼‰ */
document.getElementById('link-terms').onclick=(e)=>{ e.preventDefault(); alert("ã€åˆ©ç”¨è¦ç´„ã€‘\næœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯æ•‘æ€¥è¦è«‹ã®ã€å†åˆ¤æ–­ã€ã‚’æ”¯æ´ã™ã‚‹ä¸€èˆ¬æƒ…å ±ã§ã™ã€‚è¨ºæ–­ãƒ»æ²»ç™‚ã®æŒ‡ç¤ºã¯è¡Œã„ã¾ã›ã‚“ã€‚æ³•ä»¤ã§èªã‚ã‚‰ã‚Œã‚‹ç¯„å›²ã§ã€å½“æ–¹ã¯æå®³ã«å¯¾ã—è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚"); };
document.getElementById('link-privacy').onclick=(e)=>{ e.preventDefault(); alert("ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã€‘\nå€‹äººæƒ…å ±ã¯ã‚µãƒ¼ãƒä¿å­˜ã—ã¾ã›ã‚“ã€‚ã‚¢ã‚¯ã‚»ã‚¹è§£æã¯ç¾æ™‚ç‚¹ã§å®Ÿæ–½ã—ã¾ã›ã‚“ã€‚ä»Šå¾Œå°å…¥æ™‚ã¯æ˜ç¤ºã—ã€åŒæ„ã‚’å¾—ã¾ã™ã€‚"); };

/* åˆæœŸè¡¨ç¤º */
render();
</script>
</body>
</html>
